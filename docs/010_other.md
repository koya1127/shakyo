# 010_other.md

## その他・非機能要件など

- APIキーはクライアントに渡さず、Webサーバーのみで管理
- エラーハンドリング：GPTエラー／通信失敗／ファイル未保存対応
- ログ出力：整形結果、ID、タイムスタンプ
- Git管理とREADMEの整備
- セキュリティ対策：トークン・アクセス制限・ログ監査など
- `/text/<id>` API において、ファイルが存在しない場合は 404 を返すように実装済み。
  - Flask側のルーティングで `formatted_texts/<id>.txt` の有無をチェック。
  - APIレスポンス形式は `{ "error": "not found" }`。

## 写経判定仕様（2025年4月追加）

- ユーザーが写経した文章をGPTに送信し、元の段落と比較して正しさを判定する。
- GPTは以下の3段階で評価する：
  - OK：意味が通っており、写経として受理可能
  - CLOSE：意味は近いが表現にズレがある（ユーザーに再確認を促す）
  - NG：意味が通っていない or 原文と一致しないため再挑戦が必要

- 評価プロンプト例：
  「次の2つの文章は、ユーザーが写経を行った結果と元の段落です……（略）」
- GPTから「OK」が返ってきた場合のみ、次の段落に進める。

## 写経保存機能（2025年4月）

- `POST /write/<id>` にて、textareaの入力内容をサーバーに送信
- ファイルは `written_texts/<id>_<step>.txt` に保存される
- `step` はURLクエリから取得し、段落ごとの保存に対応
- 保存後、自動的に次の段落に遷移（`redirect(url_for(...))`）

## Git運用メモ（2025年4月）

- `git init` 済み。ブランチは `master`。
- コミットはチャット進行単位で実施、粒度細かめ。
- 最新の作業は `web_backend/app.py` に未ステージの変更あり（写経ビュー関連）。
- `docs/`, `templates/`, `written_texts/` などは untracked のため `.gitignore` に追加検討中。
- 主なコミットログは `git log --oneline` にて確認（最新：66cd7c8）。

